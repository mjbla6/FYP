import visa
rm = visa.ResourceManager()
my_instrument = rm.open_resource('GPIB0::23::INSTR')

## AMPLITUDE ## softkey panel
Reference_Level = "DISPlay:WINDow:TRACe:Y:SCALe:RLEVel " ## DBm or W
Scale_Div = "DISPlay:WINDow:TRACe:Y:SCALe:PDIVision " ## Db
Display_Mode = "DISPlay:WINDow:TRACe:Y:SCALe:SPACing " ## Log or Linear
Sensitivity_Automatic = "SENSe:POWer:DC:RANGe:LOWer:AUTO 1" ## do not use 0, any number will work and it will automatically assign a number
Sensitivity_Manual = "SENSe:POWer:DC:RANGe:LOWer " ## nW W etc
Peak_to_Reference_Level_Max = "CALCulate:MARKer:MAXimum" ## seems to work, need to test with signal
Peak_to_Reference_Level_SR = "CALCulate:MARKer:SRLevel" ## seems to work, need to test with signal
Trace_Integ = "CALCulate:TPOWer:STATe " ## On or Off

## AMPLITUDE SETUP ## within amplitude menu
Reference_Level_Position = "DISPlay:WINDow:TRACe:Y:SCALe:RPOSition " ## x num of divisions
Amplitude_Units = "UNIT:POW " ## AUTO or W
Auto_Ranging = "SENSe:POWer:DC:RANGe:AUTO " ## On or Off
Auto_Zero = "CALibration:ZERO:AUTO " ## 1 = On, 0 = Off
Auto_Chop_Modea = "SENSe:CHOP:STATe " ## On or Off
Power_Calibration = "CALibration:POWer:STATe " ## ask bill, user not selectable?
Amplitude_Correction_Set = "SENSe:CORRection:CSET " ## 1,2,3,4
Amplitude_Correction_Mode = "SENSe:CORRection:STATe " ## On or Off

## APPLICATIONS ## fixed button at bottom
Application_List = my_instrument.query("INSTrument:CATalog?") ##Get a list of measurement modes and applications
Application_Select = "INSTrument:SELect " ## enter in one of the apps from the list in ' '
Auto_Align = "CALibration:ALIGn" ## test with signal
Auto_Align_Marker = "CALibration:ALIGn:MARKer" ## test with signal
Auto_Measure = "DISPlay:WINDow:TRACe:ALL:SCALe:AUTO" ## test with signal

## BANDWIDTH/SWEEP ## softkey panel
Res_BW_Auto = "SENSe:BANDwidth:RESolution:AUTO 1"
Res_BW_Man = "SENSe:BANDwidth:RESolution " ## nm etc
Video_BW_Auto = "SENSe:BANDwidth:VIDeo:AUTO 1"
Video_BW_Man = "SENSe:BANDwidth:VIDeo " ## Hz 
Sweep_Time_Auto = "SENSe:SWEep:TIME:AUTO 1"
Sweep_Time_Man = "SENSe:SWEep:TIME " ## s
Repeat_Sweep = "INITiate:CONTinuous " ## On or Off
Single_Sweep = "INITiate:IMMediate" ## Command ignored?

## MORE BW/SWEEP FUNCTIONS ## within bandwidth/sweep menu
Trigger_Mode_Internal = "TRIG:SOUR IMM"
Trigger_Mode_Gated = "????" ## no instructions or syntax for this
Trigger_Mode_External = "TRIG:SOUR EXT"
ADC_Pos = "TRIGger:SLOPe POS"
ADC_Neg = "TRIGger:SLOPe NEG"
####### NOT TESTED ########
ADC_AC = "TRIGger:SLOPe EITH" ## not sure about eith, test
Trigger_Delay = "TRIGger:DELay " ## value in s, ms, etc
ADC_Trig_Sync = "TRIGger:OUTPut " ## on, off or auto 1
ADC_Sync_Out = "TRIGger:OUTPut:PULSe:STATe " ## on, off, 1 ,0
ADC_Sync_Out_Duty_Cycle = "TRIGger:OUTPut:PULSe:DCYCle " ## numerical value
ADC_Sync_Out_Pulse_Width = "TRIGger:OUTPut:PULSe:WIDTh " ## value in s, ms, etc
##Local GPIB GoToLocal Command ???

## MARKER ##
## will need to make alterations to this marker selection depending on how the interaction works
marker_num = raw_input('Select Marker [1,2,3,4]: ')
## need to go through and check
Active_Marker_On = "CALCulate:MARKer[%s]:STATe ON" %marker_num ## on,off,1,0 
Active_Marker_Off = "CALCulate:MARKer[%s]:AOFF" %marker_num ## maybe 1?
Active_Trace = "CALCulate:MARKer[%s]:TRACe " %marker_num ## TRA|TRB|TRC|TRD|TRE|TRF need to figure out what these do, may need a new variable for each one
Peak_Search = "CALCulate:MARKer[%s]:MAXimum" %marker_num
Marker_to_CENTER = "CALCulate:MARKer[%s]:SCENter" %marker_num
Marker_to_REF LEVEL = "CALCulate:MARKer[%s]:SRLevel" %marker_num
## MARKER SETUP ##
Normal_Marker_Units = "CALCulate:MARKer[%s]:X:READout" %marker_num
BW_Marker_Units = "CALCulate:MARKer[%s]:FUNCtion:BANDwidth:READout" %marker_num
Delta_Marker_Units = "CALCulate:MARKer[%s]:FUNCtion:DELTa:X:READout" %marker_num
Normal_Delta_Marker_Interpolation = "CALCulate:MARKer[%s]:INTerpolation" %marker_num
Bandwidth_Marker_Interpolation = "CALCulate:MARKer[%s]:FUNCtion:BANDwidth:INTerpolation" %marker_num
Peak_Excursion = "CALCulate:MARKer[%s]:PEXCursion:PEAK" %marker_num
Pit_Excursion = "CALCulate:MARKer[%s]:PEXCursion:PIT" %marker_num
Use_Marker_Search_Threshold = "CALCulate:THReshold"
Noise_Marker_Reference Bandwidth = "CALCulate:MARKer[%s]:FUNCtion:NOISe:BANDwidth" %marker_num
Peak_Search_at_End_of_Each_Sweep = "????" ## no command
OSNR_Noise = "CALCulate:MARKer[%s]:FUNCtion:OSNR:MODE" %marker_num
OSNR_Noise_Off = "CALCulate:MARKer[%s]:FUNCtion:OSNR:OFFSet" %marker_num

## MORE MARKER FUNCTIONS ##
##Marker Search Menu
##Search Mode Peak
Peak_Search = "CALCulate:MARKer[%s]:MAXimum" %marker_num
Next_Peak_Down = "CALCulate:MARKer[%s]:MAXimum:NEXT" %marker_num
Next_Peak_Left = "CALCulate:MARKer[%s]:MAXimum:LEFT" %marker_num
Next_Peak_Right = "CALCulate:MARKer[%s]:MAXimum:RIGHt" %marker_num
Active_Marker_Peak_On = "CALCulate:MARKer[%s]:STATe" %marker_num
Active_Marker_Peak_Off = "CALCulate:MARKer[%s]:AOFF" %marker_num
##Search Mode Pit
Pit_Search = "CALCulate:MARKer[%s]:MINimum" %marker_num
Next_Pit_Up = "CALCulate:MARKer[%s]:MINimum:NEXT" %marker_num
Next_Pit_Left = "CALCulate:MARKer[%s]:MINimum:LEFT" %marker_num
Next_Pit_Right = "CALCulate:MARKer[%s]:MINimum:RIGHt" %marker_num
Active_Marker_Pit_On = "CALCulate:MARKer[%s]:STATe" %marker_num
Active_Marker_Pit_Off = "CALCulate:MARKer[%s]:AOFF" %marker_num

Marker_BW = "CALCulate:MARKer[%s]:FUNCtion:BANDwidth:STATe" %marker_num
Noise_Marker = "CALCulate:MARKer[%s]:FUNCtion:NOISe:STATe" %marker_num
Delta_Marker = "CALCulate:MARKer[%s]:FUNCtion:DELTa:STATe" %marker_num
OSNR_Marker = "CALCulate:MARKer[%s]:FUNCtion:OSNR[:STATe]" %marker_num
##Line Marker Menu
##Wavelength Marker 1
Integration_Limit_1 = "CALCulate:TPOWer:IRANge:LOWer"
Search_Limit_1 = "CALCulate:MARKer[%s]:SRANge:LOWer" %marker_num
Sweep_Limit_1 = "SENSe:WAVelength:SRANge:LOWer"
##Wavelength Marker 2
Integration_Limit_2 = "CALCulate:TPOWer:IRANge:UPPer"
Search_Limit_2 = "CALCulate:MARKer[%s]:SRANge:UPPer" %marker_num
Sweep_Limit_2 = "SENSe:WAVelength:SRANge:UPPer"
Line_Markers_Off = "CALCulate:MARKer[%s]:SRANge Off" %marker_num
##Advanced Line Marker Functions
Integrate_Limit = "CALCulate:TPOWer:IRANge:STATe"
Search_Limit = "CALCulate:MARKer[%s]:SRANge:STATe" %marker_num
Sweep_Limit = "SENSe:WAVelength:SRANge:STATe"
Trace_Integ = "CALCulate:TPOWer:STATe"
Preset = "SYSTem:PRESet"
Print = "HCOPy:IMMediate"

## SAVE/RECALL ##
##Save Menu
Save_Measurement = "*SAV"
Trace_Only = "MMEMory:STORe:TRACe"
##Save Graphics
Graphic_Format = "HCOPy:DEVice:LANGuage
Save_To = "????" ## assuming this will be a raw_input user defined?
File Name = "????" ## assuming this will be a raw_input user defined?
##Recall Menu
Recall_Measurement = "*RCL
Trace = "MMEMory:LOAD:TRACe
Recall_From = "????" ## assuming this will be a raw_input user defined?

Delete_Menu = "MMEMory:DELete
Format Floppy Disk = "MMEMory:INITialize
##Backup/Restore Menu
Backup_Internal_Memory = "????" ## no command
Restore_Internal_Memory = "????" ## no command

Fast_Meas_SAVE = "????" ## no command
Fast_Meas_RECALL = "????" ## no command
System = "????" ## no command
##Help
Show_Critical_Errors = "SYSTem:ERRor?"
Show_BW_Errors = "SYSTem:ERRor?"
Show_Notices = "????" ## no command
Show_Warnings = "SYSTem:ERRor?"
Revision = "*IDN?"


Set_Title DISPlay:WINDow:TEXT:DATA
## OPTIONS ##
##Current Source Setup:
##SOURce:CATalog?
##SOURce:CURRent:PULSe:STATe
##SOURce:CURRent:LIMit
##SOURce:STATe
Light_Source_Setup SOURce:STATe
##Printer Setup
Printer_Location HCOPy:DESTination
## CALIBRATION ##
##Power Cal Setup
Factory_Power_Cal_Date = "CALibration:DATE?"
User_Power_Cal_Date = "CALibration:POWer:DATE?"
Set_Calibration_Power = "CALibration:POWer:VALue"
Execute_Power_Calibration = "CALibration:POWer"
Calibrate_Second_Path_Power = "CALibration:POWer:PATh[1|2]" ##on|off
##Wavelength Calibration Setup
Factory_Wavelength_Cal_Date = "CALibration:DATE?"
User_Wavelength_Cal_Date = "CALibration:WAVelength:DATE?"
Signal_Source_Wavelengths_Referenced_In = "SENSe:CORRection:RVELocity:MEDium"
Set_Calibration_Wavelength = "CALibration:WAVelength:VALue"
Perform_Calibration_Ext = "CALibration:WAVelength:EXTernal"
Perform_Calibration_Int = "CALibration:WAVelength:INTernal"
Calibrate_Second_Path_Wavelength = "CALibration:WAV:PATh[1|2]" ## on|off

##Move Active Area No command
##More System Functions
##OSA State
####Display Setup
##Agilent Logo
##Date/Time
##Title                               no commands for all these tasks
##Active Function Area Assist
##Set Time/ Date
##Current Time
##Current Date
##Time Zone

## SERVICE MENU ##
Power_State = "SYSTem:PON:TYPE"
Factory_Preset
Configure_Network
Firmware_Upgrade

##Adv Service Functions
Zero_Now = "CALibration:ZERO:AUTO"
Grating_Order = "SENSe:GORDer:AUTO"
Wavelength_Limit = "SENSe:WAVelength:LIMit"
##More Adv Service Functions
TransZ_2_3_Lock = "SENSe:POWer:DC:RANGe:LOCK"
Multipoint_Align = "CALibration:ALIGn:EXTernal"
##Enhanced WL Cal Setup
Perform_EWC = "CALibration:WAVelength:EXTernal"
Calibration_Range = "CALibration:WAVelength:EWC"
OSA_Extended_State = "???" ##no info

## AUTO MEASURE SETUP ##
Span = "DISPlay:WINDow:TRACe:X:SCALe:AUTO:SPAN"
Span_Auto = "DISPlay:WINDow:TRACe:X:SCALe:AUTO:SPAN:AUTO"
Scale_div = "DISPlay:WINDow:TRACe:Y:SCALe:AUTO:PDIVision"
Scale_div_Auto = "DISPlay:WINDow:TRACe:Y:SCALe:AUTO:PDIVision:AUTO"
Auto_Meas_at_Marker = "DISPlay:WINDow:TRACe:ALL:SCALe:AUTO:MARKer"
Optimize_Sensitivity = "DISPlay:WINDow:TRACe:ALL:SCALe:AUTO:OPTimize"

## GPIB AND NETWORK SETUP##
## NO INFO

## USER SHARE IDENTIDY ##
User_Name = "SYSTem:COMMunicate:NETWork:USERname"
Password = "SYSTem:COMMunicate:NETWork:PASSword"
Workgroup = "SYSTem:COMMunicate:NETWork:WORKgroup"
##File Shares
1_through_4_files = "MMEMory:FSHare:PATH"

##Printer Shares
1_through_4_printer = "HCOPy:DEVice:PSHare:ADDRess"
Traces = "no info" ## no commands

##Active Trace
##Update and View commands below will
##affect active trace

Update A_F = "TRACe:FEED:CONTrol"
View A_F = "DISPlay:WINDow:TRACe:STATe"
Hold A_F_Max = "CALCulate[1 | 2 | 3 | 4 | 5 | 6]:MAXimum:STATe"
Hold A_F_Min = "CALCulate[1 | 2 | 3 | 4 | 5 | 6]:MINimum:STATe"
Reset_Min_Max_Hold_Max = "CALCulate[1 | 2 | 3 | 4 | 5 | 6]:MAXimum:CLEar"
Reset_Min_Max__Hold_Min = "CALCulate[1 | 2 | 3 | 4 | 5 | 6]:MINimum:CLEar"
Trace_Math = "CALCulate:MATH:STATe"
Default_Math = "CALCulate:MATH:EXPRession:DEFine"
Exchange_Menu = "TRACe:EXCHange"
Offset = "CALCulate[1 | 2 | 3 | 4 | 5 | 6]:OFFSet"
All_Math_Off = "CALCulate[1 | 2 | 3 | 4 | 5 | 6]:MATH:STATe"
Averaging_On_Off = "CALCulate:AVERage:STATe"

##Trace Setup
Sweep_Points = "SENSe:SWEep:POINts"

## WAVELENGTH ##
Center_Wavelength = "SENSe:WAVelength:CENTer"
Span = "SENSe:WAVelength:SPAN"
Start_WL = "SENSe:WAVelength:STARt"
Stop_WL = "SENSe:WAVelength:STOP"
Peak_to_Center_Max = "CALCulate:MARKer:MAXimum"
Peak_to_Center = "CALCulate:MARK:SCENter"
##Wavelength Setup
Wavelength_Units "no info" ## no commands
Wavelength_Calibration = "CALibrate:WAVelength:STATe"
Wavelength_Offset = "SENSe:WAVelength:OFFSet"
Center_Wavelength_Step_Size = "SENse:WAVelength:CENTer:STEP:INCRement"
Wavelength_Referenced_In = "SENSe:CORRection:RVELocity:MEDium"

##print my_instrument.write("TRIGger:SLOPe NEG")
